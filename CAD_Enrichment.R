library(scales)
library(rsnps)
library(org.Hs.eg.db)
library(clusterProfiler)
library(enrichplot)
library(reactome.db)
library(ReactomePA)
SNPs <- c("rs17114036", "rs11206510", "rs515135", "rs646776", "rs4845625", "rs17464857", "rs16986953", "rs6544713", "rs1561198", "rs2252641", "rs6725887", "rs9818870", "rs17087335", "rs1878406", "rs7692387", "rs273909", "rs12526453", "rs6903956", "rs17609940", "rs10947789", "rs12190287", "rs2048327", "rs4252120", "rs2023938", "rs10953541", "rs11556924", "rs3918226", "rs264", "rs2954029", "rs3217992", "rs579459", "rs2505083", "rs2047009", "rs11203042", "rs12413409", "rs10840293", "rs974819", "rs964184", "rs7136259", "rs3184504", "rs11830157", "rs9319428", "rs4773144", "rs2895811", "rs56062135", "rs7173743", "rs8042271", "rs17514846", "rs216172", "rs12936587", "rs46522", "rs7212798", "rs663129", "rs2075650", "rs12976411", "rs1122608", "rs9982601", "rs180803")
SNP2Gene <- data.frame("SNPs" = SNPs, "Genes" = gsub(":.*", "", ncbi_snp_summary(SNPs)$gene2), stringsAsFactors=FALSE)
write.csv(SNP2Gene, file = "SNP2Gene.csv", row.names=FALSE)
paste(percent(sum(is.na(SNP2Gene$Gene))/length(SNP2Gene$Gene)), "of SNPs could not be mapped to Genes", sep=" ")
CAD_GENES <- SNP2Gene$Gene
CAD_ENTREZ <- bitr(CAD_GENES, fromType="SYMBOL", toType="ENTREZID", OrgDb=org.Hs.eg.db)
write.csv(CAD_ENTREZ, file = "CAD_ENTREZ.csv", row.names=FALSE)
CAD_ENTREZ <- CAD_ENTREZ$ENTREZID
CAD_BP_GO <- enrichGO(gene=CAD_ENTREZ, OrgDb=org.Hs.eg.db, ont="BP", pAdjustMethod="bonferroni", pvalueCutoff=0.05)
CAD_BP_GO <- setReadable(CAD_BP_GO, OrgDb=org.Hs.eg.db, keyType="ENTREZID")
write.csv(CAD_BP_GO, file = "CAD_BP_GO.csv", row.names=FALSE)
dev.new()
dotplot(CAD_BP_GO, title="CAD GO Enrichment: Biological Processes")
CAD_PA <- enrichPathway(gene=CAD_ENTREZ, pvalueCutoff=0.05, minGSSize=8)
CAD_PA <- setReadable(CAD_PA, OrgDb=org.Hs.eg.db, keyType="ENTREZID")
write.csv(CAD_PA, file = "CAD_PA.csv", row.names=FALSE)
dev.new()
dotplot(CAD_PA, title="CAD Biological Pathway Enrichment")
